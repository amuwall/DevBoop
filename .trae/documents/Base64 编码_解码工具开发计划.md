# Base64 编码/解码工具开发计划

本计划旨在开发并集成一个功能完善的 Base64 编解码工具模块，满足文本/文件转换、URL 安全处理及高性能要求。

## 1. 目录与文件结构
将在 `src/renderer/src/plugins` 下创建 `Base64Converter` 目录：
- `index.tsx`: 插件主逻辑与 UI 组件实现。
- `Base64Converter.test.tsx`: 单元测试文件。
- `utils.ts` (可选): 抽离核心编解码逻辑以便复用和测试。

## 2. 功能实现细节

### 2.1 核心逻辑 (utils.ts)
- **文本编解码**:
  - 使用 `TextEncoder` / `TextDecoder` 确保 UTF-8 字符（如中文）正确处理。
  - 封装 `btoa` / `atob` 并处理 Unicode 问题。
- **URL 安全模式**:
  - 替换字符集：`+` -> `-`, `/` -> `_`。
  - 处理末尾填充符 `=` 的保留或移除逻辑。
- **二进制处理**:
  - 针对文件操作，使用 `Uint8Array` 进行中间转换，避免大字符串带来的内存压力。

### 2.2 UI 交互设计 (index.tsx)
基于 Fluent UI 构建现代化界面：
- **模式切换**: 提供 Tab 或 Toggle 切换 "文本模式" 与 "文件模式"。
- **输入/输出**:
  - 文本模式：双栏布局，左侧输入，右侧实时显示结果。支持 "复制"、"清空"、"互换" 操作。
  - 文件模式：文件选择器 + 拖拽上传区。编码后显示 Base64 片段并提供 "复制" / "下载 .txt"。解码模式下输入 Base64 并提供 "下载文件" 按钮。
- **选项配置**:
  - Checkbox: "URL 安全模式"。
  - Checkbox: "实时转换" (针对文本)。

### 2.3 集成 (App.tsx)
- 在 `src/renderer/src/App.tsx` 中导入 `Base64Plugin`。
- 在 `useEffect` 初始化流程中调用 `registerPlugin(Base64Plugin)` 完成注册。

## 3. 测试策略
使用 `vitest` 编写测试用例 (`Base64Converter.test.tsx`)：
- **功能测试**:
  - 中文/特殊字符的正确编码与还原。
  - 标准 Base64 与 URL Safe Base64 的转换验证。
  - 无效 Base64 输入的错误捕获与提示。
- **组件测试**:
  - 模拟文件上传事件，验证处理逻辑。
  - 验证 UI 状态变化（如切换模式、勾选选项）。

## 4. 执行步骤
1.  **创建核心工具函数**: 实现并测试编解码逻辑。
2.  **开发 UI 组件**: 构建界面并绑定逻辑。
3.  **集成插件**: 注册到应用主程序。
4.  **验证与优化**: 运行测试，检查大文件性能，完善文档。
